<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SIMRS HR - Staff Management</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <!-- Add Noto Sans Font -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        body {
            font-family: 'Noto Sans', sans-serif;
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #cbd5e1; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #94a3b8; 
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: scale(0.98); }
            to { opacity: 1; transform: scale(1); }
        }
        .animate-fade-in {
            animation: fadeIn 0.3s ease-out forwards;
        }
    </style>
</head>
<body class="bg-[#F7F7F7] text-[#2C2C2C]">
    <div id="root"></div>

    <!-- React Application -->
    <script type="text/babel" data-type="module">
        import React, { useState, useEffect, useRef } from 'https://esm.sh/react@18.2.0';
        import { createRoot } from 'https://esm.sh/react-dom@18.2.0/client';
        import { 
            LayoutDashboard, Users, UserPlus, Activity, Search, Menu, 
            FileText, AlertTriangle, Trash2, Upload, Clock, Briefcase, 
            Award, BookOpen, Filter, MoreVertical, Eye, Edit, X, ChevronRight,
            ChevronDown, CheckCircle, Phone, Mail, MapPin, Calendar, User,
            Target, UserCheck, GraduationCap, FileBarChart,
            Sun, Cloud, Moon 
        } from 'https://esm.sh/lucide-react@0.263.1';

        // --- KONFIGURASI KATEGORI PROFESI ---
        const JOB_CATEGORIES = {
            MEDIS: ['Dokter Spesialis', 'Dokter Umum', 'Dokter Gigi'],
            KEPERAWATAN: ['Perawat', 'Bidan'],
            PENUNJANG: ['Farmasi', 'Laboratorium', 'Radiologi', 'Gizi', 'Fisioterapi', 'Rekam Medis'],
            NON_MEDIS: ['Manajemen & Admin', 'Keuangan', 'IT & SIMRS', 'Teknik (IPSRS)', 'Keamanan', 'Layanan Umum']
        };

        // --- DAFTAR UNIT KERJA ---
        const WORK_UNITS = [
            "Instalasi Gawat Darurat (IGD)",
            "Instalasi Rawat Jalan (Poliklinik)",
            "Instalasi Rawat Inap",
            "Intensive Care Unit (ICU / ICCU / NICU)",
            "Kamar Operasi (IBS)",
            "Kamar Bersalin (VK)",
            "Instalasi Farmasi",
            "Laboratorium",
            "Radiologi",
            "Rehabilitasi Medik",
            "Instalasi Gizi",
            "Rekam Medis",
            "Manajemen & Administrasi",
            "Keuangan & Akuntansi",
            "IT & SIMRS",
            "SDM & Diklat",
            "IPSRS (Teknik & Pemeliharaan)",
            "Keamanan & Ketertiban",
            "Front Office & Pendaftaran",
            "Sanitasi & Laundry"
        ];

        // Profesi WAJIB SIP
        const REQUIRED_SIP_DOCS = [
            ...JOB_CATEGORIES.MEDIS,
            ...JOB_CATEGORIES.KEPERAWATAN,
            ...JOB_CATEGORIES.PENUNJANG
        ];

        // --- DATA MOCKUP (DITAMBAHKAN DATA KINERJA LENGKAP) ---
        const INITIAL_DATA = [
            { 
                id: 1, employeeId: "199001012018011001", name: "dr. Andi Pratama, Sp.PD-KGEH", role: "Spesialis Penyakit Dalam", unit: "Instalasi Rawat Jalan (Poliklinik)",
                category: "Dokter Spesialis", employeeType: "Mitra", joinDate: "2018-05-12", 
                sipNumber: "503/SIP/2018", sipExpiry: "2024-04-01", 
                currentShift: "Pagi", performance: [85, 90, 88], skpPoints: 25, status: "Active",
                gender: "Laki-laki", birthPlace: "Jakarta", birthDate: "1990-01-01", 
                phone: "0812-3456-7890", email: "andi.pratama@rs.com", address: "Jl. Menteng Raya No. 10, Jakarta Pusat",
                // Data Kinerja Tambahan
                kpi: [
                    { indicator: "Respon Time Pasien Baru", target: "< 5 Menit", actual: "3 Menit", score: 95 },
                    { indicator: "Kepuasan Pasien", target: "90%", actual: "92%", score: 100 },
                    { indicator: "Kelengkapan Rekam Medis", target: "100%", actual: "98%", score: 90 }
                ],
                behavior: [
                    { aspect: "Integritas", score: 90, note: "Sangat jujur dan transparan" },
                    { aspect: "Kerjasama Tim", score: 85, note: "Aktif dalam diskusi medis" },
                    { aspect: "Kedisiplinan", score: 88, note: "Selalu hadir tepat waktu" }
                ],
                discipline: [], // Kosong berarti tidak ada pelanggaran
                training: [
                    { name: "Simposium Penyakit Dalam 2023", date: "2023-05-10", type: "Seminar", duration: "2 Hari" },
                    { name: "Advanced Life Support", date: "2022-11-20", type: "Workshop", duration: "3 Hari" }
                ],
                skp: { target: 50, realization: 25, grade: "Baik" }
            },
            { 
                id: 2, employeeId: "199505052022021002", name: "dr. Kevin Sanjaya", role: "Dokter Jaga IGD", unit: "Instalasi Gawat Darurat (IGD)",
                category: "Dokter Umum", employeeType: "Kontrak", joinDate: "2022-01-15", 
                sipNumber: "789/SIP/2022", sipExpiry: "2026-01-15",
                currentShift: "Malam", performance: [80, 85, 87], skpPoints: 10, status: "Active",
                 gender: "Laki-laki", birthPlace: "Bandung", birthDate: "1995-05-05", 
                 phone: "0811-2233-4455", email: "kevin.s@rs.com", address: "Jl. Dago Atas No. 55, Bandung",
                 kpi: [
                    { indicator: "Respon Time IGD", target: "< 3 Menit", actual: "4 Menit", score: 75 },
                    { indicator: "Penanganan Kritis", target: "100%", actual: "95%", score: 85 }
                ],
                behavior: [
                    { aspect: "Integritas", score: 80, note: "-" },
                    { aspect: "Kerjasama Tim", score: 90, note: "Sangat membantu rekan perawat" },
                    { aspect: "Kedisiplinan", score: 75, note: "Beberapa kali terlambat shift malam" }
                ],
                discipline: [
                    { date: "2023-01-10", type: "Teguran Lisan", description: "Keterlambatan > 15 menit" }
                ],
                training: [
                    { name: "ATLS Certification", date: "2022-02-01", type: "Sertifikasi", duration: "5 Hari" }
                ],
                skp: { target: 50, realization: 10, grade: "Cukup" }
            },
            { 
                id: 7, employeeId: "198803102010032001", name: "Ns. Siti Aminah, S.Kep", role: "Kepala Ruangan ICU", unit: "Intensive Care Unit (ICU / ICCU / NICU)",
                category: "Perawat", employeeType: "Tetap", joinDate: "2010-03-10", 
                sipNumber: "445/SIK/2019", sipExpiry: "2025-08-20", 
                currentShift: "Pagi", performance: [95, 92, 94], skpPoints: 40, status: "Active",
                gender: "Perempuan", birthPlace: "Surabaya", birthDate: "1988-03-10", 
                phone: "0813-9876-5432", email: "siti.aminah@rs.com", address: "Jl. Gubeng No. 12, Surabaya",
                kpi: [], behavior: [], discipline: [], training: [], skp: { target: 50, realization: 40, grade: "Sangat Baik" }
            },
            { 
                id: 8, employeeId: "199204122016042002", name: "Bd. Nurul Hidayah, A.Md.Keb", role: "Bidan Pelaksana", unit: "Kamar Bersalin (VK)",
                category: "Bidan", employeeType: "Tetap", joinDate: "2016-04-12", 
                sipNumber: "654/SIB/2016", sipExpiry: "2025-05-12", 
                currentShift: "Malam", performance: [90, 93], skpPoints: 35, status: "Active",
                gender: "Perempuan", birthPlace: "Yogyakarta", birthDate: "1992-04-12",
                phone: "0856-7890-1234", email: "nurul.h@rs.com", address: "Jl. Malioboro No. 5",
                kpi: [], behavior: [], discipline: [], training: [], skp: { target: 50, realization: 35, grade: "Baik" }
            },
            { 
                id: 10, employeeId: "198902202014022003", name: "apt. Dewi Sartika, S.Farm", role: "Apoteker PJ", unit: "Instalasi Farmasi",
                category: "Farmasi", employeeType: "Tetap", joinDate: "2014-02-20", 
                sipNumber: "111/SIPA/2014", sipExpiry: "2024-02-20", 
                currentShift: "Pagi", performance: [96, 95], skpPoints: 48, status: "Active",
                gender: "Perempuan", birthPlace: "Medan", birthDate: "1989-02-20",
                phone: "0812-1122-3344", email: "dewi.s@rs.com", address: "Jl. Gatot Subroto No. 88",
                kpi: [], behavior: [], discipline: [], training: [], skp: { target: 50, realization: 48, grade: "Sangat Baik" }
            },
            { 
                id: 15, employeeId: "199701152021011005", name: "Budi Santoso, S.Kom", role: "Staff IT SIMRS", unit: "IT & SIMRS",
                category: "IT & SIMRS", employeeType: "Kontrak", joinDate: "2021-01-15", 
                sipNumber: "-", sipExpiry: "-", 
                currentShift: "Office Hour", performance: [80, 82], skpPoints: 0, status: "Active",
                gender: "Laki-laki", birthPlace: "Semarang", birthDate: "1997-01-15",
                phone: "0819-0011-2233", email: "budi.it@rs.com", address: "Jl. Pemuda No. 45",
                kpi: [], behavior: [], discipline: [], training: [], skp: { target: 0, realization: 0, grade: "-" }
            },
            { 
                id: 19, employeeId: "198508012019081006", name: "Ir. Joko Susilo", role: "Kepala IPSRS", unit: "IPSRS (Teknik & Pemeliharaan)",
                category: "Teknik (IPSRS)", employeeType: "Tetap", joinDate: "2019-08-01", 
                sipNumber: "-", sipExpiry: "-", 
                currentShift: "Pagi", performance: [90], skpPoints: 0, status: "Active",
                gender: "Laki-laki", birthPlace: "Solo", birthDate: "1985-08-01",
                phone: "0813-5566-7788", email: "joko.s@rs.com", address: "Jl. Slamet Riyadi No. 99",
                kpi: [], behavior: [], discipline: [], training: [], skp: { target: 0, realization: 0, grade: "-" }
            }
        ];

        // --- COMPONENTS UTILS ---
        const Modal = ({ isOpen, onClose, title, children }) => {
            if (!isOpen) return null;
            return (
                <div className="fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 animate-fade-in p-4 backdrop-blur-sm">
                    <div className="bg-white rounded-xl shadow-2xl w-full max-w-3xl max-h-[85vh] overflow-hidden flex flex-col border border-gray-100">
                        <div className="flex justify-between items-center p-5 border-b border-gray-100 bg-gray-50">
                            <h3 className="text-lg font-bold text-gray-800">{title}</h3>
                            <button onClick={onClose} className="p-2 hover:bg-gray-200 rounded-full text-gray-500 transition-colors"><X size={20}/></button>
                        </div>
                        <div className="p-0 overflow-y-auto flex-1">{children}</div>
                    </div>
                </div>
            );
        };

        // --- MAIN COMPONENTS ---

        const Sidebar = ({ activeTab, setActiveTab, isOpen, toggleSidebar }) => {
            const menuItems = [
                { id: 'dashboard', label: 'Dashboard Eksekutif', icon: LayoutDashboard },
                { id: 'directory', label: 'Direktori & Shift', icon: Users },
                { id: 'crud', label: 'Input Data SDM', icon: UserPlus },
                { id: 'performance', label: 'Evaluasi Kinerja', icon: Activity },
            ];

            return (
                <React.Fragment>
                    {isOpen && <div className="fixed inset-0 z-20 bg-black bg-opacity-50 md:hidden" onClick={toggleSidebar}></div>}
                    <div className={`fixed inset-y-0 left-0 z-30 w-64 bg-white shadow-xl transform transition-transform duration-300 ease-in-out ${isOpen ? 'translate-x-0' : '-translate-x-full'} md:translate-x-0 md:static md:inset-0 border-r border-gray-100`}>
                        <div className="flex items-center justify-center h-20 border-b border-gray-100 bg-white">
                            <h1 className="text-2xl font-bold text-[#17B8A5]">SIMRS<span className="text-gray-800">HR</span></h1>
                        </div>
                        <nav className="mt-8 px-4 space-y-2">
                            {menuItems.map((item) => (
                                <button
                                    key={item.id}
                                    onClick={() => {
                                        setActiveTab(item.id);
                                        if (window.innerWidth < 768) toggleSidebar();
                                    }}
                                    className={`flex items-center w-full px-4 py-3 rounded-lg transition-all duration-200 ${
                                        activeTab === item.id ? 'bg-[#17B8A5] text-white shadow-md font-semibold' : 'text-gray-600 hover:bg-gray-50 hover:text-[#17B8A5]'
                                    }`}
                                >
                                    <item.icon size={20} className="mr-3" />
                                    <span className="text-left">{item.label}</span>
                                </button>
                            ))}
                        </nav>
                        <div className="absolute bottom-0 w-full p-4 border-t border-gray-100 bg-gray-50">
                            <div className="flex items-center gap-3">
                                <div className="w-10 h-10 rounded-full bg-gray-200 flex items-center justify-center font-bold text-gray-500">AD</div>
                                <div>
                                    <p className="text-sm font-bold text-gray-700">Admin HR</p>
                                    <p className="text-xs text-gray-400">Online</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </React.Fragment>
            );
        };

        const Dashboard = ({ staffData }) => {
            const [modalData, setModalData] = useState({ isOpen: false, title: '', list: [] });

            const getSipWarnings = () => {
                const today = new Date();
                return staffData.map(staff => {
                    if (staff.sipExpiry === '-' || !staff.sipExpiry) return null;
                    
                    const sipDate = new Date(staff.sipExpiry);
                    const diffTime = sipDate - today;
                    const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                    
                    let status = '';
                    if (diffDays <= 30) status = 'red';      
                    else if (diffDays <= 90) status = 'orange'; 
                    else if (diffDays <= 180) status = 'yellow'; 
                    
                    if (!status) return null;
                    return { ...staff, warningStatus: status, daysLeft: diffDays };
                }).filter(item => item !== null).sort((a,b) => a.daysLeft - b.daysLeft);
            };

            const warningList = getSipWarnings();
            
            const getStaffByGroup = (groups) => staffData.filter(s => groups.includes(s.category));
            const getStaffOnDuty = () => staffData.filter(s => s.currentShift === 'Pagi' || s.currentShift === 'Office Hour');

            // NEW: Fungsi untuk memfilter pegawai berdasarkan nama shift
            const getStaffByShift = (shiftName) => {
                if (shiftName === 'Pagi') {
                    // Masukkan Pagi dan Office Hour ke Shift Pagi
                    return staffData.filter(s => s.currentShift === 'Pagi' || s.currentShift === 'Office Hour');
                }
                return staffData.filter(s => s.currentShift === shiftName);
            };

            const openListModal = (title, dataList) => {
                setModalData({ isOpen: true, title, list: dataList });
            };

            const WidgetCard = ({ title, count, icon: Icon, colorClass, borderColorClass, onClick }) => (
                <div 
                    onClick={onClick}
                    className={`bg-white p-5 rounded-xl shadow-sm border-l-4 ${borderColorClass} cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all duration-300 group`}
                >
                    <div className="flex justify-between items-start">
                        <div>
                            <p className="text-gray-500 text-xs font-bold uppercase tracking-wider">{title}</p>
                            <h3 className="text-3xl font-bold text-gray-800 mt-2 group-hover:text-[#17B8A5] transition-colors">{count}</h3>
                        </div>
                        <div className={`p-3 rounded-lg bg-gray-50 ${colorClass} group-hover:bg-white transition-colors`}>
                            <Icon size={24} />
                        </div>
                    </div>
                    <p className={`text-xs mt-4 font-semibold flex items-center gap-1 ${colorClass.replace('text-', 'text-opacity-80 text-')}`}>
                         Lihat Daftar <ChevronRight size={12}/>
                    </p>
                </div>
            );

            return (
                <div className="space-y-8 animate-fade-in">
                    <div>
                        <h2 className="text-2xl font-bold text-[#2C2C2C]">Dashboard Operasional SDM</h2>
                        <p className="text-gray-500 text-sm">Ringkasan data pegawai dan status operasional hari ini.</p>
                    </div>
                    
                    <div className="grid grid-cols-1 md:grid-cols-4 gap-6">
                        <WidgetCard 
                            title="Medis & Perawat"
                            count={getStaffByGroup([...JOB_CATEGORIES.MEDIS, ...JOB_CATEGORIES.KEPERAWATAN]).length}
                            icon={Users}
                            colorClass="text-[#17B8A5]"
                            borderColorClass="border-[#17B8A5]"
                            onClick={() => openListModal('Daftar Tenaga Medis & Keperawatan', getStaffByGroup([...JOB_CATEGORIES.MEDIS, ...JOB_CATEGORIES.KEPERAWATAN]))}
                        />
                        <WidgetCard 
                            title="Penunjang Medis"
                            count={getStaffByGroup(JOB_CATEGORIES.PENUNJANG).length}
                            icon={Activity}
                            colorClass="text-purple-500"
                            borderColorClass="border-purple-500"
                            onClick={() => openListModal('Daftar Penunjang Medis', getStaffByGroup(JOB_CATEGORIES.PENUNJANG))}
                        />
                        <WidgetCard 
                            title="Non-Medis (Umum)"
                            count={getStaffByGroup(JOB_CATEGORIES.NON_MEDIS).length}
                            icon={Briefcase}
                            colorClass="text-orange-500"
                            borderColorClass="border-orange-500"
                            onClick={() => openListModal('Daftar Pegawai Non-Medis', getStaffByGroup(JOB_CATEGORIES.NON_MEDIS))}
                        />
                         <WidgetCard 
                            title="Dinas Pagi Ini"
                            count={getStaffOnDuty().length}
                            icon={Clock}
                            colorClass="text-blue-500"
                            borderColorClass="border-blue-500"
                            onClick={() => openListModal('Daftar Pegawai Shift Pagi', getStaffOnDuty())}
                        />
                    </div>

                    {/* NEW: INFORMASI JADWAL SHIFT (INTERACTIVE) */}
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div 
                            onClick={() => openListModal('Daftar Pegawai Shift Pagi (07.00 - 15.00)', getStaffByShift('Pagi'))}
                            className="bg-blue-50 border border-blue-100 p-4 rounded-xl flex items-center gap-3 cursor-pointer hover:shadow-md hover:bg-blue-100 transition-all"
                        >
                            <div className="p-2 bg-white rounded-full text-blue-500"><Sun size={20}/></div>
                            <div>
                                <p className="text-xs text-blue-500 font-bold uppercase">Shift Pagi</p>
                                <p className="text-sm font-bold text-gray-700">07.00 - 15.00 <span className="font-normal text-gray-500">(Poli)</span></p>
                            </div>
                        </div>
                        <div 
                            onClick={() => openListModal('Daftar Pegawai Shift Sore (15.00 - 23.00)', getStaffByShift('Sore'))}
                            className="bg-orange-50 border border-orange-100 p-4 rounded-xl flex items-center gap-3 cursor-pointer hover:shadow-md hover:bg-orange-100 transition-all"
                        >
                            <div className="p-2 bg-white rounded-full text-orange-500"><Cloud size={20}/></div>
                            <div>
                                <p className="text-xs text-orange-500 font-bold uppercase">Shift Sore</p>
                                <p className="text-sm font-bold text-gray-700">15.00 - 23.00 <span className="font-normal text-gray-500">(Poli)</span></p>
                            </div>
                        </div>
                        <div 
                            onClick={() => openListModal('Daftar Pegawai Shift Malam (23.00 - 07.00)', getStaffByShift('Malam'))}
                            className="bg-indigo-50 border border-indigo-100 p-4 rounded-xl flex items-center gap-3 cursor-pointer hover:shadow-md hover:bg-indigo-100 transition-all"
                        >
                            <div className="p-2 bg-white rounded-full text-indigo-600"><Moon size={20}/></div>
                            <div>
                                <p className="text-xs text-indigo-600 font-bold uppercase">Shift Malam</p>
                                <p className="text-sm font-bold text-gray-700">23.00 - 07.00 <span className="font-normal text-gray-500">(IGD)</span></p>
                            </div>
                        </div>
                    </div>

                    <div className="bg-white rounded-xl shadow-sm overflow-hidden border border-gray-200">
                        <div className="p-5 border-b border-gray-100 flex justify-between items-center bg-gray-50">
                            <h3 className="font-bold text-gray-800 flex items-center gap-2">
                                <AlertTriangle className="text-yellow-600" size={20} />
                                Monitoring Masa Berlaku SIP
                            </h3>
                            <span className="bg-red-100 text-red-600 text-xs px-3 py-1 rounded-full font-bold">
                                {warningList.length} Perlu Perhatian
                            </span>
                        </div>
                        <div className="p-5">
                            {warningList.length === 0 ? (
                                <div className="text-center py-10 flex flex-col items-center justify-center text-gray-400">
                                    <CheckCircle size={48} className="mb-2 text-green-500 opacity-50"/>
                                    <p>Semua SIP Pegawai Aman (> 6 Bulan).</p>
                                </div>
                            ) : (
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    {warningList.map(staff => {
                                        let bgColor, textColor, icon, label, borderColor;

                                        if (staff.warningStatus === 'red') {
                                            bgColor = 'bg-red-50';
                                            borderColor = 'border-red-200';
                                            textColor = 'text-red-700';
                                            icon = 'ðŸš¨';
                                            label = 'CRITICAL (< 1 Bulan)';
                                        } else if (staff.warningStatus === 'orange') {
                                            bgColor = 'bg-orange-50';
                                            borderColor = 'border-orange-200';
                                            textColor = 'text-orange-700';
                                            icon = 'âš ï¸';
                                            label = 'WARNING (< 3 Bulan)';
                                        } else { // Yellow
                                            bgColor = 'bg-yellow-50';
                                            borderColor = 'border-yellow-200';
                                            textColor = 'text-yellow-700';
                                            icon = 'âš¡';
                                            label = 'ATTENTION (< 6 Bulan)';
                                        }

                                        return (
                                            <div key={staff.id} className={`flex items-center justify-between p-4 border rounded-lg shadow-sm transition-transform hover:scale-[1.01] ${bgColor} ${borderColor}`}>
                                                <div className="flex items-center gap-4">
                                                    <div className="text-3xl">{icon}</div>
                                                    <div>
                                                        <p className="font-bold text-gray-800">{staff.name}</p>
                                                        <div className="flex items-center gap-2 mt-1">
                                                            <span className={`text-[10px] font-bold px-2 py-0.5 rounded-full bg-white border ${borderColor} ${textColor}`}>
                                                                {label}
                                                            </span>
                                                            <span className="text-xs text-gray-500">Exp: {staff.sipExpiry}</span>
                                                        </div>
                                                    </div>
                                                </div>
                                                <button 
                                                    onClick={() => openListModal('Detail Pegawai', [staff])}
                                                    className="text-xs font-semibold underline text-gray-500 hover:text-gray-800"
                                                >
                                                    Lihat
                                                </button>
                                            </div>
                                        )
                                    })}
                                </div>
                            )}
                        </div>
                    </div>

                    <Modal 
                        isOpen={modalData.isOpen} 
                        onClose={() => setModalData({...modalData, isOpen: false})} 
                        title={modalData.title}
                    >
                        {modalData.list.length === 0 ? (
                            <div className="p-8 text-center text-gray-400">Tidak ada data pegawai dalam kategori ini.</div>
                        ) : (
                            <div className="overflow-x-auto">
                                <table className="w-full text-sm text-left">
                                    <thead className="bg-gray-50 text-gray-600 font-bold border-b">
                                        <tr>
                                            <th className="p-4 w-10">No</th>
                                            <th className="p-4">ID Pegawai</th>
                                            <th className="p-4">Nama</th>
                                            <th className="p-4">Unit Kerja</th>
                                            <th className="p-4">Jabatan</th>
                                            <th className="p-4">Status</th>
                                        </tr>
                                    </thead>
                                    <tbody className="divide-y divide-gray-100">
                                        {modalData.list.map((s, idx) => (
                                            <tr key={s.id} className="hover:bg-gray-50 transition-colors">
                                                <td className="p-4 text-gray-400">{idx + 1}</td>
                                                <td className="p-4 font-mono text-xs font-semibold text-[#17B8A5]">{s.employeeId}</td>
                                                <td className="p-4 font-medium text-gray-800">{s.name}</td>
                                                <td className="p-4 text-gray-500">{s.unit}</td>
                                                <td className="p-4 text-gray-500">{s.role}</td>
                                                <td className="p-4">
                                                    <span className="bg-green-100 text-green-700 px-2 py-0.5 rounded text-xs font-bold">Aktif</span>
                                                </td>
                                            </tr>
                                        ))}
                                    </tbody>
                                </table>
                            </div>
                        )}
                    </Modal>
                </div>
            );
        };

        const StaffDirectory = ({ staffData, onDelete, onEdit }) => {
            const [filter, setFilter] = useState('All');
            const [search, setSearch] = useState('');
            const [openMenuId, setOpenMenuId] = useState(null);
            const [selectedStaff, setSelectedStaff] = useState(null); 

            useEffect(() => {
                const handleClickOutside = () => setOpenMenuId(null);
                window.addEventListener('click', handleClickOutside);
                return () => window.removeEventListener('click', handleClickOutside);
            }, []);

            const handleMenuClick = (e, id) => {
                e.stopPropagation();
                setOpenMenuId(openMenuId === id ? null : id);
            };

            const handleRowClick = (staff) => {
                setSelectedStaff(staff);
            };

            const filteredData = staffData.filter(staff => {
                const matchCategory = filter === 'All' || staff.category === filter;
                const matchSearch = staff.name.toLowerCase().includes(search.toLowerCase()) || 
                                    staff.unit.toLowerCase().includes(search.toLowerCase()) ||
                                    staff.employeeId.includes(search);
                return matchCategory && matchSearch;
            });

            return (
                <div className="space-y-6 animate-fade-in">
                    <div className="flex flex-col md:flex-row justify-between gap-4 items-end md:items-center">
                        <div>
                            <h2 className="text-2xl font-bold text-[#2C2C2C]">Direktori Pegawai</h2>
                            <p className="text-sm text-gray-500">Kelola data seluruh pegawai rumah sakit.</p>
                        </div>
                        <div className="flex flex-col sm:flex-row gap-3 w-full md:w-auto">
                            <div className="relative flex-1">
                                <Search className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" size={18} />
                                <input 
                                    type="text" placeholder="Cari Nama / ID / Unit..." 
                                    className="w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#17B8A5] text-sm"
                                    value={search} onChange={(e) => setSearch(e.target.value)}
                                />
                            </div>
                            <div className="relative">
                                <Filter className="absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400" size={18} />
                                <select 
                                    className="pl-10 pr-8 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#17B8A5] appearance-none bg-white text-sm cursor-pointer"
                                    value={filter} onChange={(e) => setFilter(e.target.value)}
                                >
                                    <option value="All">Semua Profesi</option>
                                    <optgroup label="Medis">
                                        {JOB_CATEGORIES.MEDIS.map(c => <option key={c} value={c}>{c}</option>)}
                                    </optgroup>
                                    <optgroup label="Keperawatan">
                                        {JOB_CATEGORIES.KEPERAWATAN.map(c => <option key={c} value={c}>{c}</option>)}
                                    </optgroup>
                                    <optgroup label="Penunjang">
                                        {JOB_CATEGORIES.PENUNJANG.map(c => <option key={c} value={c}>{c}</option>)}
                                    </optgroup>
                                    <optgroup label="Non-Medis">
                                        {JOB_CATEGORIES.NON_MEDIS.map(c => <option key={c} value={c}>{c}</option>)}
                                    </optgroup>
                                </select>
                                <ChevronDown className="absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 pointer-events-none" size={14} />
                            </div>
                        </div>
                    </div>

                    <div className="bg-white rounded-xl shadow-sm overflow-visible border border-gray-200 min-h-[400px]">
                        <div className="overflow-x-auto">
                            <table className="w-full text-left">
                                <thead className="bg-gray-50 border-b border-gray-100">
                                    <tr>
                                        <th className="px-6 py-4 text-xs font-bold text-gray-500 uppercase w-32">ID Pegawai</th>
                                        <th className="px-6 py-4 text-xs font-bold text-gray-500 uppercase">Nama & Profesi</th>
                                        <th className="px-6 py-4 text-xs font-bold text-gray-500 uppercase">Jabatan & Unit</th>
                                        <th className="px-6 py-4 text-xs font-bold text-gray-500 uppercase">Shift</th>
                                        <th className="px-6 py-4 text-xs font-bold text-gray-500 uppercase text-right">Aksi</th>
                                    </tr>
                                </thead>
                                <tbody className="divide-y divide-gray-100">
                                    {filteredData.map((staff) => {
                                        let avatarColor = 'bg-gray-400';
                                        if (JOB_CATEGORIES.MEDIS.includes(staff.category)) avatarColor = 'bg-[#17B8A5]';
                                        else if (JOB_CATEGORIES.KEPERAWATAN.includes(staff.category)) avatarColor = 'bg-blue-400';
                                        else if (JOB_CATEGORIES.PENUNJANG.includes(staff.category)) avatarColor = 'bg-purple-400';
                                        else if (JOB_CATEGORIES.NON_MEDIS.includes(staff.category)) avatarColor = 'bg-orange-400';

                                        return (
                                            <tr 
                                                key={staff.id} 
                                                onClick={() => handleRowClick(staff)}
                                                className="hover:bg-[#F0FDFA] transition-colors cursor-pointer group"
                                            >
                                            <td className="px-6 py-4 align-top">
                                                <span className="font-mono text-xs font-bold text-gray-500 bg-gray-100 px-2 py-1 rounded">{staff.employeeId}</span>
                                            </td>
                                            
                                            <td className="px-6 py-4">
                                                <div className="flex items-center gap-3">
                                                    <div className={`w-10 h-10 rounded-full flex items-center justify-center text-white font-bold text-sm shadow-sm ${avatarColor}`}>
                                                        {staff.name.substring(0,2).toUpperCase()}
                                                    </div>
                                                    <div>
                                                        <p className="font-bold text-gray-800 text-sm group-hover:text-[#17B8A5] transition-colors">{staff.name}</p>
                                                        <p className="text-xs text-gray-400">{staff.category}</p>
                                                    </div>
                                                </div>
                                            </td>

                                            <td className="px-6 py-4 align-middle">
                                                <p className="text-sm font-bold text-gray-700">{staff.role}</p>
                                                <p className="text-xs text-gray-500">{staff.unit}</p>
                                                <span className="text-[10px] text-gray-400 border border-gray-200 px-1.5 py-0.5 rounded mt-1 inline-block bg-white">{staff.employeeType}</span>
                                            </td>

                                            <td className="px-6 py-4 align-middle">
                                                <span className={`px-3 py-1 text-xs rounded-full font-bold flex w-fit items-center gap-2 ${staff.currentShift === 'Pagi' ? 'bg-green-100 text-green-700' : staff.currentShift === 'Malam' ? 'bg-indigo-100 text-indigo-700' : 'bg-gray-100 text-gray-500'}`}>
                                                <Clock size={12}/>
                                                {staff.currentShift}
                                                </span>
                                            </td>

                                            <td className="px-6 py-4 text-right relative align-middle">
                                                <button 
                                                    onClick={(e) => handleMenuClick(e, staff.id)} 
                                                    className="p-2 rounded-full hover:bg-gray-200 text-gray-400 hover:text-gray-700 transition"
                                                >
                                                    <MoreVertical size={18} />
                                                </button>
                                                
                                                {openMenuId === staff.id && (
                                                    <div className="absolute right-8 top-8 w-48 bg-white shadow-xl rounded-lg border border-gray-100 z-50 animate-fade-in origin-top-right overflow-hidden">
                                                        <button 
                                                            onClick={(e) => { e.stopPropagation(); handleRowClick(staff); setOpenMenuId(null); }}
                                                            className="w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-3 border-b border-gray-50"
                                                        >
                                                            <Eye size={16} className="text-[#17B8A5]"/> Lihat Detail
                                                        </button>
                                                        <button 
                                                            onClick={(e) => { e.stopPropagation(); onEdit(staff); setOpenMenuId(null); }}
                                                            className="w-full text-left px-4 py-3 text-sm text-gray-700 hover:bg-gray-50 flex items-center gap-3 border-b border-gray-50"
                                                        >
                                                            <Edit size={16} className="text-blue-500"/> Edit Data
                                                        </button>
                                                        <button 
                                                            onClick={(e) => { e.stopPropagation(); onDelete(staff.id); setOpenMenuId(null); }}
                                                            className="w-full text-left px-4 py-3 text-sm text-red-600 hover:bg-red-50 flex items-center gap-3"
                                                        >
                                                            <Trash2 size={16}/> Hapus
                                                        </button>
                                                    </div>
                                                )}
                                            </td>
                                            </tr>
                                        )
                                    })}
                                </tbody>
                            </table>
                        </div>
                    </div>

                    {/* DETAIL MODAL (PROFIL PEGAWAI) */}
                    <Modal isOpen={!!selectedStaff} onClose={() => setSelectedStaff(null)} title="Detail Data Pegawai">
                        {selectedStaff && (
                            <div className="space-y-8">
                                {/* HEADER PROFIL */}
                                <div className="flex flex-col md:flex-row items-center md:items-start gap-6 border-b border-gray-100 pb-6">
                                    <div className="w-24 h-24 rounded-full bg-gray-100 flex items-center justify-center text-3xl font-bold text-gray-400 shadow-inner">
                                        {selectedStaff.name.substring(0,2).toUpperCase()}
                                    </div>
                                    <div className="text-center md:text-left flex-1">
                                        <h2 className="text-2xl font-bold text-gray-800">{selectedStaff.name}</h2>
                                        <p className="text-[#17B8A5] font-semibold">{selectedStaff.role}</p>
                                        <div className="flex flex-wrap justify-center md:justify-start gap-2 mt-3">
                                            <span className="bg-gray-100 text-gray-600 text-xs px-3 py-1 rounded-full border border-gray-200 font-mono">
                                                ID: {selectedStaff.employeeId}
                                            </span>
                                            <span className="bg-[#E8F8F6] text-[#0F8F80] text-xs px-3 py-1 rounded-full border border-[#17B8A5]">
                                                {selectedStaff.category}
                                            </span>
                                            <span className="bg-blue-50 text-blue-600 text-xs px-3 py-1 rounded-full border border-blue-200">
                                                {selectedStaff.employeeType}
                                            </span>
                                        </div>
                                    </div>
                                </div>

                                {/* BIODATA DIRI SECTION (BARU) */}
                                <div className="space-y-4">
                                    <h4 className="text-sm font-bold text-gray-400 uppercase tracking-wider border-b border-gray-100 pb-2 flex items-center gap-2">
                                        <User size={16}/> Biodata Diri
                                    </h4>
                                    <div className="grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4">
                                        <div className="flex items-start gap-3">
                                            <div className="mt-0.5 text-gray-400"><User size={16}/></div>
                                            <div>
                                                <p className="text-xs text-gray-400">Jenis Kelamin</p>
                                                <p className="text-sm font-semibold text-gray-700">{selectedStaff.gender || '-'}</p>
                                            </div>
                                        </div>
                                        <div className="flex items-start gap-3">
                                            <div className="mt-0.5 text-gray-400"><Calendar size={16}/></div>
                                            <div>
                                                <p className="text-xs text-gray-400">Tempat, Tanggal Lahir</p>
                                                <p className="text-sm font-semibold text-gray-700">
                                                    {selectedStaff.birthPlace ? `${selectedStaff.birthPlace}, ` : ''} 
                                                    {selectedStaff.birthDate || '-'}
                                                </p>
                                            </div>
                                        </div>
                                        <div className="flex items-start gap-3">
                                            <div className="mt-0.5 text-gray-400"><Phone size={16}/></div>
                                            <div>
                                                <p className="text-xs text-gray-400">Nomor Telepon</p>
                                                <p className="text-sm font-semibold text-gray-700">{selectedStaff.phone || '-'}</p>
                                            </div>
                                        </div>
                                        <div className="flex items-start gap-3">
                                            <div className="mt-0.5 text-gray-400"><Mail size={16}/></div>
                                            <div>
                                                <p className="text-xs text-gray-400">Email</p>
                                                <p className="text-sm font-semibold text-gray-700">{selectedStaff.email || '-'}</p>
                                            </div>
                                        </div>
                                        <div className="flex items-start gap-3 md:col-span-2">
                                            <div className="mt-0.5 text-gray-400"><MapPin size={16}/></div>
                                            <div>
                                                <p className="text-xs text-gray-400">Alamat Domisili</p>
                                                <p className="text-sm font-semibold text-gray-700">{selectedStaff.address || '-'}</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                {/* INFORMASI PEKERJAAN & LEGALITAS */}
                                <div className="grid grid-cols-1 md:grid-cols-2 gap-6 pt-4">
                                    <div className="space-y-4">
                                        <h4 className="text-sm font-bold text-gray-400 uppercase tracking-wider border-b border-gray-100 pb-2 flex items-center gap-2">
                                            <Briefcase size={16}/> Informasi Pekerjaan
                                        </h4>
                                        <div className="grid grid-cols-2 gap-4">
                                            <div>
                                                <p className="text-xs text-gray-400">Unit Kerja</p>
                                                <p className="text-sm font-semibold text-gray-700">{selectedStaff.unit}</p>
                                            </div>
                                            <div>
                                                <p className="text-xs text-gray-400">Tanggal Bergabung</p>
                                                <p className="text-sm font-semibold text-gray-700">{selectedStaff.joinDate}</p>
                                            </div>
                                            <div>
                                                <p className="text-xs text-gray-400">Shift Saat Ini</p>
                                                <p className="text-sm font-semibold text-gray-700">{selectedStaff.currentShift}</p>
                                            </div>
                                            <div>
                                                <p className="text-xs text-gray-400">Poin SKP</p>
                                                <p className="text-sm font-semibold text-gray-700">{selectedStaff.skpPoints}</p>
                                            </div>
                                        </div>
                                    </div>

                                    <div className="space-y-4">
                                         <h4 className="text-sm font-bold text-gray-400 uppercase tracking-wider border-b border-gray-100 pb-2 flex items-center gap-2">
                                            <FileText size={16}/> Legalitas
                                         </h4>
                                        {selectedStaff.sipNumber !== '-' ? (
                                            <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                                <div className="flex items-center gap-2 mb-2">
                                                    <Briefcase size={16} className="text-yellow-600"/>
                                                    <span className="font-bold text-yellow-800 text-sm">Surat Izin Praktik (SIP)</span>
                                                </div>
                                                <div className="space-y-2">
                                                    <div className="flex justify-between border-b border-yellow-100 pb-1">
                                                        <span className="text-xs text-yellow-700">Nomor</span>
                                                        <span className="text-xs font-mono font-bold text-yellow-900">{selectedStaff.sipNumber}</span>
                                                    </div>
                                                    <div className="flex justify-between">
                                                        <span className="text-xs text-yellow-700">Berlaku Sampai</span>
                                                        <span className="text-xs font-bold text-yellow-900">{selectedStaff.sipExpiry}</span>
                                                    </div>
                                                </div>
                                            </div>
                                        ) : (
                                            <div className="text-sm text-gray-400 italic bg-gray-50 p-4 rounded-lg text-center">
                                                Tidak memerlukan SIP untuk posisi ini.
                                            </div>
                                        )}
                                    </div>
                                </div>
                                
                                <div className="flex justify-end pt-4 border-t border-gray-100 gap-3">
                                    <button onClick={() => setSelectedStaff(null)} className="px-4 py-2 rounded-lg text-gray-500 hover:bg-gray-100 transition text-sm">Tutup</button>
                                    <button className="px-4 py-2 rounded-lg bg-[#17B8A5] text-white hover:bg-[#0F8F80] transition text-sm font-bold shadow-sm">Cetak Data</button>
                                </div>
                            </div>
                        )}
                    </Modal>
                </div>
            );
        };

        const StaffForm = ({ onAddStaff }) => {
            const [formData, setFormData] = useState({
                employeeId: '', name: '', role: '', unit: '', category: 'Dokter Umum', employeeType: 'Tetap',
                sipNumber: '', sipExpiry: '', sipFile: null,
                // Biodata Fields
                gender: 'Laki-laki', birthPlace: '', birthDate: '', phone: '', email: '', address: ''
            });
            
            const handleSubmit = (e) => {
                e.preventDefault();
                if(!formData.employeeId || !formData.name || !formData.unit) return alert("ID, Nama dan Unit Kerja Wajib Diisi");
                
                const isMedical = REQUIRED_SIP_DOCS.includes(formData.category);
                if(isMedical && !formData.sipNumber) {
                    return alert(`Kategori "${formData.category}" wajib melengkapi data SIP.`);
                }

                onAddStaff({
                    ...formData,
                    id: Math.random(),
                    joinDate: new Date().toISOString().split('T')[0],
                    performance: [],
                    skpPoints: 0,
                    currentShift: 'Libur',
                    status: 'Active',
                    kpi: [], behavior: [], discipline: [], training: [], skp: { target: 0, realization: 0, grade: "-" }
                });
                alert("Data Staf Berhasil Disimpan");
                setFormData({ 
                    employeeId: '', name: '', role: '', unit: '', category: 'Dokter Umum', employeeType: 'Tetap', 
                    sipNumber: '', sipExpiry: '', gender: 'Laki-laki', birthPlace: '', birthDate: '', phone: '', email: '', address: '' 
                });
            };

            const isMedicalForm = REQUIRED_SIP_DOCS.includes(formData.category);
            const ChevronDownIcon = () => <ChevronRight className="rotate-90 text-gray-400" size={16}/>;

            return (
                <div className="space-y-6 animate-fade-in">
                    <h2 className="text-2xl font-bold text-[#2C2C2C]">Input Data SDM Baru</h2>
                    
                    <div className="grid grid-cols-1 lg:grid-cols-2 gap-8">
                        {/* KOLOM 1: DATA PERSONAL & KEPEGAWAIAN */}
                        <div className="bg-white p-8 rounded-xl shadow-sm border border-gray-200">
                        <h3 className="font-bold text-gray-800 mb-6 flex items-center gap-2 border-b pb-4">
                            <UserPlus size={20} className="text-[#17B8A5]" /> Identitas & Penempatan
                        </h3>
                        <div className="space-y-5">
                            <div>
                                <label className="text-xs font-bold text-gray-500 uppercase tracking-wide">ID Pegawai (NIP/NIK)</label>
                                <input 
                                    value={formData.employeeId} onChange={e => setFormData({...formData, employeeId: e.target.value})}
                                    className="w-full mt-1 px-4 py-2.5 border border-gray-300 rounded-lg font-mono focus:ring-2 focus:ring-[#17B8A5] focus:border-transparent outline-none transition" 
                                    placeholder="Contoh: 199001..." 
                                />
                            </div>
                            <div>
                                <label className="text-xs font-bold text-gray-500 uppercase tracking-wide">Nama Lengkap & Gelar</label>
                                <input 
                                    value={formData.name} onChange={e => setFormData({...formData, name: e.target.value})}
                                    className="w-full mt-1 px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#17B8A5] focus:border-transparent outline-none transition" 
                                    placeholder="Contoh: Budi Santoso, S.Kom" 
                                />
                            </div>

                            {/* BIODATA INPUT FIELDS */}
                             <div className="grid grid-cols-2 gap-5">
                                <div>
                                    <label className="text-xs font-bold text-gray-500 uppercase tracking-wide">Jenis Kelamin</label>
                                    <div className="relative">
                                        <select 
                                            value={formData.gender} onChange={e => setFormData({...formData, gender: e.target.value})}
                                            className="w-full mt-1 px-4 py-2.5 border border-gray-300 rounded-lg bg-gray-50 appearance-none focus:ring-2 focus:ring-[#17B8A5] outline-none"
                                        >
                                           <option value="Laki-laki">Laki-laki</option>
                                           <option value="Perempuan">Perempuan</option>
                                        </select>
                                        <div className="absolute right-3 top-1/2 mt-0.5 transform -translate-y-1/2 pointer-events-none"><ChevronDownIcon/></div>
                                    </div>
                                </div>
                                <div>
                                     <label className="text-xs font-bold text-gray-500 uppercase tracking-wide">No. Telepon</label>
                                     <input 
                                        value={formData.phone} onChange={e => setFormData({...formData, phone: e.target.value})}
                                        className="w-full mt-1 px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#17B8A5] outline-none" 
                                        placeholder="0812..." 
                                    />
                                </div>
                             </div>
                             <div>
                                <label className="text-xs font-bold text-gray-500 uppercase tracking-wide">Email</label>
                                <input 
                                    value={formData.email} onChange={e => setFormData({...formData, email: e.target.value})}
                                    type="email"
                                    className="w-full mt-1 px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#17B8A5] outline-none" 
                                    placeholder="email@rs.com" 
                                />
                             </div>
                             <div>
                                <label className="text-xs font-bold text-gray-500 uppercase tracking-wide">Alamat Lengkap</label>
                                <textarea 
                                    value={formData.address} onChange={e => setFormData({...formData, address: e.target.value})}
                                    className="w-full mt-1 px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-[#17B8A5] outline-none h-20 resize-none" 
                                    placeholder="Jl..." 
                                ></textarea>
                             </div>
                            
                            {/* KEPEGAWAIAN */}
                            <div className="border-t border-gray-100 pt-4 mt-2">
                                <label className="block text-sm font-bold text-[#17B8A5] mb-3">Data Kepegawaian</label>
                                <div className="grid grid-cols-2 gap-5 mb-4">
                                    <div>
                                        <label className="text-xs font-bold text-gray-500 uppercase tracking-wide">Kategori Profesi</label>
                                        <div className="relative">
                                            <select 
                                                value={formData.category} onChange={e => setFormData({...formData, category: e.target.value})}
                                                className="w-full mt-1 px-4 py-2.5 border border-gray-300 rounded-lg bg-gray-50 appearance-none focus:ring-2 focus:ring-[#17B8A5] outline-none"
                                            >
                                                <optgroup label="Medis">
                                                    {JOB_CATEGORIES.MEDIS.map(c => <option key={c} value={c}>{c}</option>)}
                                                </optgroup>
                                                <optgroup label="Keperawatan">
                                                    {JOB_CATEGORIES.KEPERAWATAN.map(c => <option key={c} value={c}>{c}</option>)}
                                                </optgroup>
                                                <optgroup label="Penunjang">
                                                    {JOB_CATEGORIES.PENUNJANG.map(c => <option key={c} value={c}>{c}</option>)}
                                                </optgroup>
                                                <optgroup label="Non-Medis">
                                                    {JOB_CATEGORIES.NON_MEDIS.map(c => <option key={c} value={c}>{c}</option>)}
                                                </optgroup>
                                            </select>
                                            <div className="absolute right-3 top-1/2 mt-0.5 transform -translate-y-1/2 pointer-events-none"><ChevronDownIcon/></div>
                                        </div>
                                    </div>
                                    <div>
                                        <label className="text-xs font-bold text-gray-500 uppercase tracking-wide">Unit Kerja</label>
                                        <div className="relative">
                                            <select 
                                                value={formData.unit} onChange={e => setFormData({...formData, unit: e.target.value})}
                                                className="w-full mt-1 px-4 py-2.5 border border-gray-300 rounded-lg bg-white appearance-none focus:ring-2 focus:ring-[#17B8A5] outline-none"
                                            >
                                                <option value="">-- Pilih Unit Kerja --</option>
                                                {WORK_UNITS.map((unit, idx) => (
                                                <option key={idx} value={unit}>{unit}</option>